var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t,e,n,r){if(t){const o=a(t,e,n,r);return t[0](o)}}function a(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function s(t,e,n,r,o,i,c){const u=function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(e,r,o,i);if(u){const o=a(e,n,r,c);t.p(o,u)}}function l(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function v(){return m(" ")}function g(){return m("")}function y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function _(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function w(t,e,n){t.classList[n?"add":"remove"](e)}class I{constructor(t=null){this.a=t,this.e=this.n=null}m(t,e,n=null){this.e||(this.e=h(e.nodeName),this.t=e,this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)f(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(d)}}let x;function S(t){x=t}function E(){if(!x)throw new Error("Function called outside component initialization");return x}const k=[],N=[],j=[],O=[],D=Promise.resolve();let A=!1;function C(t){j.push(t)}let R=!1;const B=new Set;function T(){if(!R){R=!0;do{for(let t=0;t<k.length;t+=1){const e=k[t];S(e),F(e.$$)}for(S(null),k.length=0;N.length;)N.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];B.has(e)||(B.add(e),e())}j.length=0}while(k.length);for(;O.length;)O.pop()();A=!1,R=!1,B.clear()}}function F(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const L=new Set;let z;function M(){z={r:0,c:[],p:z}}function P(){z.r||r(z.c),z=z.p}function U(t,e){t&&t.i&&(L.delete(t),t.i(e))}function q(t,e,n,r){if(t&&t.o){if(L.has(t))return;L.add(t),z.c.push((()=>{L.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function W(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let c=e.ctx;void 0!==o&&(c=c.slice(),c[o]=i);const u=t&&(e.current=t)(c);let a=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(M(),q(t,1,1,(()=>{e.blocks[n]=null})),P())})):e.block.d(1),u.c(),U(u,1),u.m(e.mount(),e.anchor),a=!0),e.block=u,e.blocks&&(e.blocks[r]=u),a&&T()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=E();if(t.then((t=>{S(n),r(e.then,1,e.value,t),S(null)}),(t=>{if(S(n),r(e.catch,2,e.error,t),S(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function H(t){t&&t.c()}function K(t,n,i){const{fragment:c,on_mount:u,on_destroy:a,after_update:s}=t.$$;c&&c.m(n,i),C((()=>{const n=u.map(e).filter(o);a?a.push(...n):r(n),t.$$.on_mount=[]})),s.forEach(C)}function X(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e){-1===t.$$.dirty[0]&&(k.push(t),A||(A=!0,D.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,o,i,c,u,a,s=[-1]){const l=x;S(e);const f=o.props||{},p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:s,skip_bound:!1};let h=!1;if(p.ctx=i?i(e,f,((t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&u(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),h&&Q(e,t)),n})):[],p.update(),h=!0,r(p.before_update),p.fragment=!!c&&c(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();o.intro&&U(e.$$.fragment),K(e,o.target,o.anchor),T()}S(l)}class G{$destroy(){X(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const J=[];function V(e,n=t){let r;const o=[];function c(t){if(i(e,t)&&(e=t,r)){const t=!J.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),J.push(n,e)}if(t){for(let t=0;t<J.length;t+=2)J[t][0](J[t+1]);J.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(i,u=t){const a=[i,u];return o.push(a),1===o.length&&(r=n(c)||t),i(e),()=>{const t=o.indexOf(a);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}const Z=V("roam-crossref"),tt=V(""),et=V([]);function nt(t){let e,n,r,o;const i=t[5].default,c=u(i,t,t[4],null),a=c||function(t){let e;return{c(){e=m(t[0])},m(t,n){f(t,e,n)},p(t,n){1&n&&$(e,t[0])},d(t){t&&d(e)}}}(t);return{c(){e=h("a"),a&&a.c(),b(e,"href",t[1]),b(e,"title",t[0])},m(i,c){var u;f(i,e,c),a&&a.m(e,null),n=!0,r||(o=y(e,"click",(u=t[2],function(t){return t.preventDefault(),u.call(this,t)})),r=!0)},p(t,[r]){c?c.p&&16&r&&s(c,i,t,t[4],r,null,null):a&&a.p&&1&r&&a.p(t,r),(!n||1&r)&&b(e,"title",t[0])},i(t){n||(U(a,t),n=!0)},o(t){q(a,t),n=!1},d(t){t&&d(e),a&&a.d(t),r=!1,o()}}}function rt(t,e,n){let r,o,i;c(t,tt,(t=>n(6,r=t))),c(t,et,(t=>n(7,o=t))),c(t,Z,(t=>n(8,i=t)));let{$$slots:u={},$$scope:a}=e,{doi:s}=e,{title:l}=e,f=document.location.origin+document.location.pathname+`?doi=${r}`;return t.$$set=t=>{"doi"in t&&n(3,s=t.doi),"title"in t&&n(0,l=t.title),"$$scope"in t&&n(4,a=t.$$scope)},[l,f,function(){!function(){if(o.length>0&&o[o.length-1].doi===r)return;et.update((t=>[...t,{doi:r,title:i}]))}(),history.pushState({url:f,title:l},l,f),tt.set(s)},s,a,u]}class ot extends G{constructor(t){super(),Y(this,t,rt,nt,i,{doi:3,title:0})}}function it(t,e,n){const r=t.slice();return r[2]=e[n],r[4]=n,r}function ct(t){let e,n,r,o,i,c=t[0].length>t[1].length&&ut(),u=t[1],a=[];for(let e=0;e<u.length;e+=1)a[e]=st(it(t,u,e));const s=t=>q(a[t],1,1,(()=>{a[t]=null}));return{c(){e=h("ul"),c&&c.c(),n=v();for(let t=0;t<a.length;t+=1)a[t].c();r=v(),o=h("li"),o.innerHTML='<div class="svelte-znxwgd">&gt;</div>I am here',b(o,"class","svelte-znxwgd")},m(t,u){f(t,e,u),c&&c.m(e,null),l(e,n);for(let t=0;t<a.length;t+=1)a[t].m(e,null);l(e,r),l(e,o),i=!0},p(t,o){if(t[0].length>t[1].length?c||(c=ut(),c.c(),c.m(e,n)):c&&(c.d(1),c=null),2&o){let n;for(u=t[1],n=0;n<u.length;n+=1){const i=it(t,u,n);a[n]?(a[n].p(i,o),U(a[n],1)):(a[n]=st(i),a[n].c(),U(a[n],1),a[n].m(e,r))}for(M(),n=u.length;n<a.length;n+=1)s(n);P()}},i(t){if(!i){for(let t=0;t<u.length;t+=1)U(a[t]);i=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)q(a[t]);i=!1},d(t){t&&d(e),c&&c.d(),p(a,t)}}}function ut(t){let e;return{c(){e=h("li"),e.innerHTML='<span style="margin-right: 3px;">...</span> \n        <div class="svelte-znxwgd">&gt;</div>',b(e,"class","svelte-znxwgd")},m(t,n){f(t,e,n)},d(t){t&&d(e)}}}function at(t){let e,n,r=ft(t[2].title)+"";return{c(){e=h("span"),n=m(r)},m(t,r){f(t,e,r),l(e,n)},p(t,e){2&e&&r!==(r=ft(t[2].title)+"")&&$(n,r)},d(t){t&&d(e)}}}function st(t){let e,n,r,o,i=t[4]>0&&function(t){let e;return{c(){e=h("div"),e.textContent=">",b(e,"class","svelte-znxwgd")},m(t,n){f(t,e,n)},d(t){t&&d(e)}}}();return r=new ot({props:{doi:t[2].doi,title:t[2].title,$$slots:{default:[at]},$$scope:{ctx:t}}}),{c(){e=h("li"),i&&i.c(),n=v(),H(r.$$.fragment),b(e,"class","svelte-znxwgd")},m(t,c){f(t,e,c),i&&i.m(e,null),l(e,n),K(r,e,null),o=!0},p(t,e){const n={};2&e&&(n.doi=t[2].doi),2&e&&(n.title=t[2].title),34&e&&(n.$$scope={dirty:e,ctx:t}),r.$set(n)},i(t){o||(U(r.$$.fragment,t),o=!0)},o(t){q(r.$$.fragment,t),o=!1},d(t){t&&d(e),i&&i.d(),X(r)}}}function lt(t){let e,n,r=t[1].length>0&&ct(t);return{c(){r&&r.c(),e=g()},m(t,o){r&&r.m(t,o),f(t,e,o),n=!0},p(t,[n]){t[1].length>0?r?(r.p(t,n),2&n&&U(r,1)):(r=ct(t),r.c(),U(r,1),r.m(e.parentNode,e)):r&&(M(),q(r,1,1,(()=>{r=null})),P())},i(t){n||(U(r),n=!0)},o(t){q(r),n=!1},d(t){r&&r.d(t),t&&d(e)}}}function ft(t){return t.length<=40?t:t.substr(0,39)+"…"}function dt(t,e,n){let r;c(t,et,(t=>n(0,r=t)));let o=[];return t.$$.update=()=>{1&t.$$.dirty&&n(1,o=r.slice(Math.max(r.length-10,0)))},[r,o]}class pt extends G{constructor(t){super(),Y(this,t,dt,lt,i,{})}}function ht(t){let e,n,r,o,i,c,u;return c=new pt({}),{c(){e=h("div"),n=h("header"),r=h("h1"),o=m(t[0]),i=v(),H(c.$$.fragment),b(r,"class","svelte-1ri4j44"),b(n,"class","svelte-1ri4j44"),b(e,"class","svelte-1ri4j44")},m(t,a){f(t,e,a),l(e,n),l(n,r),l(r,o),l(e,i),K(c,e,null),u=!0},p(t,[e]){(!u||1&e)&&$(o,t[0])},i(t){u||(U(c.$$.fragment,t),u=!0)},o(t){q(c.$$.fragment,t),u=!1},d(t){t&&d(e),X(c)}}}function mt(t,e,n){let{title:r}=e;return t.$$set=t=>{"title"in t&&n(0,r=t.title)},[r]}class vt extends G{constructor(t){super(),Y(this,t,mt,ht,i,{title:0})}}function gt(t){let e,n,r,o,i,c,a,p,g,_,I,x,S=(t[4]?t[1]:t[2])+"";const E=t[6].default,k=u(E,t,t[5],null);return{c(){e=h("div"),n=h("input"),r=v(),o=h("label"),i=h("span"),c=m(S),a=v(),p=h("div"),g=h("div"),k&&k.c(),b(n,"id",t[0]),b(n,"type","checkbox"),b(n,"class","svelte-8k7i0y"),b(o,"for",t[0]),b(o,"class","collapse__title svelte-8k7i0y"),b(o,"tabindex","0"),b(g,"class","collapse__content svelte-8k7i0y"),b(p,"class","collapse__content-wrapper svelte-8k7i0y"),b(e,"class","collapse svelte-8k7i0y"),w(e,"isOpen",t[4])},m(u,s){f(u,e,s),l(e,n),n.checked=t[4],l(e,r),l(e,o),l(o,i),l(i,c),t[8](o),l(e,a),l(e,p),l(p,g),k&&k.m(g,null),_=!0,I||(x=y(n,"change",t[7]),I=!0)},p(t,[r]){(!_||1&r)&&b(n,"id",t[0]),16&r&&(n.checked=t[4]),(!_||22&r)&&S!==(S=(t[4]?t[1]:t[2])+"")&&$(c,S),(!_||1&r)&&b(o,"for",t[0]),k&&k.p&&32&r&&s(k,E,t,t[5],r,null,null),16&r&&w(e,"isOpen",t[4])},i(t){_||(U(k,t),_=!0)},o(t){q(k,t),_=!1},d(n){n&&d(e),t[8](null),k&&k.d(n),I=!1,x()}}}function yt(t,e,n){let r,{$$slots:o={},$$scope:i}=e,{id:c}=e,{titleOpen:u}=e,{titleClosed:a}=e,s=!1;return t.$$set=t=>{"id"in t&&n(0,c=t.id),"titleOpen"in t&&n(1,u=t.titleOpen),"titleClosed"in t&&n(2,a=t.titleClosed),"$$scope"in t&&n(5,i=t.$$scope)},[c,u,a,r,s,i,o,function(){s=this.checked,n(4,s)},function(t){N[t?"unshift":"push"]((()=>{r=t,n(3,r)}))}]}class bt extends G{constructor(t){super(),Y(this,t,yt,gt,i,{id:0,titleOpen:1,titleClosed:2})}}var $t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _t(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var wt,It,xt=(function(t,e){
/*!
        localForage -- Offline Storage, Improved
        Version 1.9.0
        https://localforage.github.io/localForage
        (c) 2013-2017 Mozilla, Apache License 2.0
    */
t.exports=function t(e,n,r){function o(c,u){if(!n[c]){if(!e[c]){if(!u&&_t)return _t();if(i)return i(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var s=n[c]={exports:{}};e[c][0].call(s.exports,(function(t){var n=e[c][1][t];return o(n||t)}),s,s.exports,t,e,n,r)}return n[c].exports}for(var i=_t,c=0;c<r.length;c++)o(r[c]);return o}({1:[function(t,e,n){(function(t){var n,r,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var i=0,c=new o(l),u=t.document.createTextNode("");c.observe(u,{characterData:!0}),n=function(){u.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var a=new t.MessageChannel;a.port1.onmessage=l,n=function(){a.port2.postMessage(0)}}var s=[];function l(){var t,e;r=!0;for(var n=s.length;n;){for(e=s,s=[],t=-1;++t<n;)e[t]();n=s.length}r=!1}function f(t){1!==s.push(t)||r||n()}e.exports=f}).call(this,void 0!==$t?$t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){var r=t(1);function o(){}var i={},c=["REJECTED"],u=["FULFILLED"],a=["PENDING"];function s(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,t!==o&&p(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(t,e,n){r((function(){var r;try{r=e(n)}catch(e){return i.reject(t,e)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)}))}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,i.reject(t,e))}function o(e){n||(n=!0,i.resolve(t,e))}function c(){e(o,r)}var u=h(c);"error"===u.status&&r(u.value)}function h(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}function m(t){return t instanceof this?t:i.resolve(new this(o),t)}function v(t){var e=new this(o);return i.reject(e,t)}function g(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var c=new Array(n),u=0,a=-1,s=new this(o);++a<n;)l(t[a],a);return s;function l(t,o){function a(t){c[o]=t,++u!==n||r||(r=!0,i.resolve(s,c))}e.resolve(t).then(a,(function(t){r||(r=!0,i.reject(s,t))}))}}function y(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var c=-1,u=new this(o);++c<n;)a(t[c]);return u;function a(t){e.resolve(t).then((function(t){r||(r=!0,i.resolve(u,t))}),(function(t){r||(r=!0,i.reject(u,t))}))}}e.exports=s,s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===c)return this;var n=new this.constructor(o);return this.state!==a?f(n,this.state===u?t:e,this.outcome):this.queue.push(new l(n,t,e)),n},l.prototype.callFulfilled=function(t){i.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){i.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},i.resolve=function(t,e){var n=h(d,e);if("error"===n.status)return i.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=u,t.outcome=e;for(var o=-1,c=t.queue.length;++o<c;)t.queue[o].callFulfilled(e)}return t},i.reject=function(t,e){t.state=c,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},s.resolve=m,s.reject=v,s.all=g,s.race=y},{1:1}],3:[function(t,e,n){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==$t?$t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}var c=i();function u(){try{if(!c||!c.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}function a(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var s=Promise;function l(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function f(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function d(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function p(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",m=void 0,v={},g=Object.prototype.toString,y="readonly",b="readwrite";function $(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}function _(t){return new s((function(e){var n=t.transaction(h,b),r=a([""]);n.objectStore(h).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))}function w(t){return"boolean"==typeof m?s.resolve(m):_(t).then((function(t){return m=t}))}function I(t){var e=v[t.name],n={};n.promise=new s((function(t,e){n.resolve=t,n.reject=e})),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then((function(){return n.promise})):e.dbReady=n.promise}function x(t){var e=v[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function S(t,e){var n=v[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function E(t,e){return new s((function(n,r){if(v[t.name]=v[t.name]||T(),t.db){if(!e)return n(t.db);I(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var i=c.open.apply(c,o);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(h)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(t){t.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),x(t)}}))}function k(t){return E(t,!1)}function N(t){return E(t,!0)}function j(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function O(t){return new s((function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)}))}function D(t){return a([$(atob(t.data))],{type:t.type})}function A(t){return t&&t.__local_forage_encoded_blob}function C(t){var e=this,n=e._initReady().then((function(){var t=v[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return f(n,t,t),n}function R(t){I(t);for(var e=v[t.name],n=e.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return t.db=null,k(t).then((function(e){return t.db=e,j(t)?N(t):e})).then((function(r){t.db=e.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(e){throw S(t,e),e}))}function B(t,e,n,r){void 0===r&&(r=1);try{var o=t.db.transaction(t.storeName,e);n(null,o)}catch(o){if(r>0&&(!t.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return s.resolve().then((function(){if(!t.db||"NotFoundError"===o.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),N(t)})).then((function(){return R(t).then((function(){B(t,e,n,r-1)}))})).catch(n);n(o)}}function T(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function F(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var o=v[n.name];o||(o=T(),v[n.name]=o),o.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=C);var i=[];function c(){return s.resolve()}for(var u=0;u<o.forages.length;u++){var a=o.forages[u];a!==e&&i.push(a._initReady().catch(c))}var l=o.forages.slice(0);return s.all(i).then((function(){return n.db=o.db,k(n)})).then((function(t){return n.db=t,j(n,e._defaultConfig.version)?N(n):t})).then((function(t){n.db=o.db=t,e._dbInfo=n;for(var r=0;r<l.length;r++){var i=l[r];i!==e&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))}function L(t,e){var n=this;t=d(t);var r=new s((function(e,r){n.ready().then((function(){B(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var c=i.objectStore(n._dbInfo.storeName).get(t);c.onsuccess=function(){var t=c.result;void 0===t&&(t=null),A(t)&&(t=D(t)),e(t)},c.onerror=function(){r(c.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function z(t,e){var n=this,r=new s((function(e,r){n.ready().then((function(){B(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var c=i.objectStore(n._dbInfo.storeName).openCursor(),u=1;c.onsuccess=function(){var n=c.result;if(n){var r=n.value;A(r)&&(r=D(r));var o=t(r,n.key,u++);void 0!==o?e(o):n.continue()}else e()},c.onerror=function(){r(c.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function M(t,e,n){var r=this;t=d(t);var o=new s((function(n,o){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===g.call(e)?w(i.db).then((function(t){return t?e:O(e)})):e})).then((function(e){B(r._dbInfo,b,(function(i,c){if(i)return o(i);try{var u=c.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var a=u.put(e,t);c.oncomplete=function(){void 0===e&&(e=null),n(e)},c.onabort=c.onerror=function(){var t=a.error?a.error:a.transaction.error;o(t)}}catch(t){o(t)}}))})).catch(o)}));return l(o,n),o}function P(t,e){var n=this;t=d(t);var r=new s((function(e,r){n.ready().then((function(){B(n._dbInfo,b,(function(o,i){if(o)return r(o);try{var c=i.objectStore(n._dbInfo.storeName).delete(t);i.oncomplete=function(){e()},i.onerror=function(){r(c.error)},i.onabort=function(){var t=c.error?c.error:c.transaction.error;r(t)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function U(t){var e=this,n=new s((function(t,n){e.ready().then((function(){B(e._dbInfo,b,(function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=i.error?i.error:i.transaction.error;n(t)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function q(t){var e=this,n=new s((function(t,n){e.ready().then((function(){B(e._dbInfo,y,(function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function W(t,e){var n=this,r=new s((function(e,r){t<0?e(null):n.ready().then((function(){B(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var c=i.objectStore(n._dbInfo.storeName),u=!1,a=c.openKeyCursor();a.onsuccess=function(){var n=a.result;n?0===t||u?e(n.key):(u=!0,n.advance(t)):e(null)},a.onerror=function(){r(a.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function H(t){var e=this,n=new s((function(t,n){e.ready().then((function(){B(e._dbInfo,y,(function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).openKeyCursor(),c=[];i.onsuccess=function(){var e=i.result;e?(c.push(e.key),e.continue()):t(c)},i.onerror=function(){n(i.error)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function K(t,e){e=p.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,o=this;if(t.name){var i=t.name===n.name&&o._dbInfo.db?s.resolve(o._dbInfo.db):k(t).then((function(e){var n=v[t.name],r=n.forages;n.db=e;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=e;return e}));r=t.storeName?i.then((function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;I(t);var r=v[t.name],o=r.forages;e.close();for(var i=0;i<o.length;i++){var u=o[i];u._dbInfo.db=null,u._dbInfo.version=n}return new s((function(e,r){var o=c.open(t.name,n);o.onerror=function(t){o.result.close(),r(t)},o.onupgradeneeded=function(){o.result.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}})).then((function(t){r.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,x(n._dbInfo)}})).catch((function(e){throw(S(t,e)||s.resolve()).catch((function(){})),e}))}})):i.then((function(e){I(t);var n=v[t.name],r=n.forages;e.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new s((function(e,n){var r=c.deleteDatabase(t.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}})).then((function(t){n.db=t;for(var e=0;e<r.length;e++)x(r[e]._dbInfo)})).catch((function(e){throw(S(t,e)||s.resolve()).catch((function(){})),e}))}))}else r=s.reject("Invalid arguments");return l(r,e),r}var X={_driver:"asyncStorage",_initStorage:F,_support:u(),iterate:z,getItem:L,setItem:M,removeItem:P,clear:U,length:q,key:W,keys:H,dropInstance:K};function Q(){return"function"==typeof openDatabase}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,V="__lfsc__:",Z=V.length,tt="arbf",et="blob",nt="si08",rt="ui08",ot="uic8",it="si16",ct="si32",ut="ur16",at="ui32",st="fl32",lt="fl64",ft=Z+tt.length,dt=Object.prototype.toString;function pt(t){var e,n,r,o,i,c=.75*t.length,u=t.length,a=0;"="===t[t.length-1]&&(c--,"="===t[t.length-2]&&c--);var s=new ArrayBuffer(c),l=new Uint8Array(s);for(e=0;e<u;e+=4)n=Y.indexOf(t[e]),r=Y.indexOf(t[e+1]),o=Y.indexOf(t[e+2]),i=Y.indexOf(t[e+3]),l[a++]=n<<2|r>>4,l[a++]=(15&r)<<4|o>>2,l[a++]=(3&o)<<6|63&i;return s}function ht(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=Y[n[e]>>2],r+=Y[(3&n[e])<<4|n[e+1]>>4],r+=Y[(15&n[e+1])<<2|n[e+2]>>6],r+=Y[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function mt(t,e){var n="";if(t&&(n=dt.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===dt.call(t.buffer))){var r,o=V;t instanceof ArrayBuffer?(r=t,o+=tt):(r=t.buffer,"[object Int8Array]"===n?o+=nt:"[object Uint8Array]"===n?o+=rt:"[object Uint8ClampedArray]"===n?o+=ot:"[object Int16Array]"===n?o+=it:"[object Uint16Array]"===n?o+=ut:"[object Int32Array]"===n?o+=ct:"[object Uint32Array]"===n?o+=at:"[object Float32Array]"===n?o+=st:"[object Float64Array]"===n?o+=lt:e(new Error("Failed to get type for BinaryArray"))),e(o+ht(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=G+t.type+"~"+ht(this.result);e(V+et+n)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}}function vt(t){if(t.substring(0,Z)!==V)return JSON.parse(t);var e,n=t.substring(ft),r=t.substring(Z,ft);if(r===et&&J.test(n)){var o=n.match(J);e=o[1],n=n.substring(o[0].length)}var i=pt(n);switch(r){case tt:return i;case et:return a([i],{type:e});case nt:return new Int8Array(i);case rt:return new Uint8Array(i);case ot:return new Uint8ClampedArray(i);case it:return new Int16Array(i);case ut:return new Uint16Array(i);case ct:return new Int32Array(i);case at:return new Uint32Array(i);case st:return new Float32Array(i);case lt:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var gt={serialize:mt,deserialize:vt,stringToBuffer:pt,bufferToString:ht};function yt(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function bt(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var o=new s((function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction((function(o){yt(o,n,(function(){e._dbInfo=n,t()}),(function(t,e){r(e)}))}),r)}));return n.serializer=gt,o}function $t(t,e,n,r,o,i){t.executeSql(n,r,o,(function(t,c){c.code===c.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,u){u.rows.length?i(t,c):yt(t,e,(function(){t.executeSql(n,r,o,i)}),i)}),i):i(t,c)}),i)}function _t(t,e){var n=this;t=d(t);var r=new s((function(e,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){$t(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function wt(t,e){var n=this,r=new s((function(e,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){$t(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var i=r.rows,c=i.length,u=0;u<c;u++){var a=i.item(u),s=a.value;if(s&&(s=o.serializer.deserialize(s)),void 0!==(s=t(s,a.key,u+1)))return void e(s)}e()}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function It(t,e,n,r){var o=this;t=d(t);var i=new s((function(i,c){o.ready().then((function(){void 0===e&&(e=null);var u=e,a=o._dbInfo;a.serializer.serialize(e,(function(e,s){s?c(s):a.db.transaction((function(n){$t(n,a,"INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){i(u)}),(function(t,e){c(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void i(It.apply(o,[t,u,n,r-1]));c(e)}}))}))})).catch(c)}));return l(i,n),i}function xt(t,e,n){return It.apply(this,[t,e,n,1])}function St(t,e){var n=this;t=d(t);var r=new s((function(e,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){$t(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function Et(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){$t(e,r,"DELETE FROM "+r.storeName,[],(function(){t()}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function kt(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){$t(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(e,n){var r=n.rows.item(0).c;t(r)}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function Nt(t,e){var n=this,r=new s((function(e,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){$t(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function jt(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){$t(e,r,"SELECT key FROM "+r.storeName,[],(function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function Ot(t){return new s((function(e,n){t.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);e({db:t,storeNames:o})}),(function(t,e){n(e)}))}),(function(t){n(t)}))}))}function Dt(t,e){e=p.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,o=this;return l(r=t.name?new s((function(e){var r;r=t.name===n.name?o._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(Ot(r))})).then((function(t){return new s((function(e,n){t.db.transaction((function(r){function o(t){return new s((function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){n(e)}))}))}for(var i=[],c=0,u=t.storeNames.length;c<u;c++)i.push(o(t.storeNames[c]));s.all(i).then((function(){e()})).catch((function(t){n(t)}))}),(function(t){n(t)}))}))})):s.reject("Invalid arguments"),e),r}var At={_driver:"webSQLStorage",_initStorage:bt,_support:Q(),iterate:wt,getItem:_t,setItem:xt,removeItem:St,clear:Et,length:kt,key:Nt,keys:jt,dropInstance:Dt};function Ct(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Rt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function Bt(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}function Tt(){return!Bt()||localStorage.length>0}function Ft(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=Rt(t,e._defaultConfig),Tt()?(e._dbInfo=n,n.serializer=gt,s.resolve()):s.reject()}function Lt(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}}));return l(n,t),n}function zt(t,e){var n=this;t=d(t);var r=n.ready().then((function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r}));return l(r,e),r}function Mt(t,e){var n=this,r=n.ready().then((function(){for(var e=n._dbInfo,r=e.keyPrefix,o=r.length,i=localStorage.length,c=1,u=0;u<i;u++){var a=localStorage.key(u);if(0===a.indexOf(r)){var s=localStorage.getItem(a);if(s&&(s=e.serializer.deserialize(s)),void 0!==(s=t(s,a.substring(o),c++)))return s}}}));return l(r,e),r}function Pt(t,e){var n=this,r=n.ready().then((function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e}));return l(r,e),r}function Ut(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(t.keyPrefix)&&r.push(i.substring(t.keyPrefix.length))}return r}));return l(n,t),n}function qt(t){var e=this.keys().then((function(t){return t.length}));return l(e,t),e}function Wt(t,e){var n=this;t=d(t);var r=n.ready().then((function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return l(r,e),r}function Ht(t,e,n){var r=this;t=d(t);var o=r.ready().then((function(){void 0===e&&(e=null);var n=e;return new s((function(o,i){var c=r._dbInfo;c.serializer.serialize(e,(function(e,r){if(r)i(r);else try{localStorage.setItem(c.keyPrefix+t,e),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||i(t),i(t)}}))}))}));return l(o,n),o}function Kt(t,e){if(e=p.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,o=this;return l(r=t.name?new s((function(e){t.storeName?e(Rt(t,o._defaultConfig)):e(t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),e),r}var Xt={_driver:"localStorageWrapper",_initStorage:Ft,_support:Ct(),iterate:Mt,getItem:zt,setItem:Ht,removeItem:Wt,clear:Lt,length:qt,key:Pt,keys:Ut,dropInstance:Kt},Qt=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},Yt=function(t,e){for(var n=t.length,r=0;r<n;){if(Qt(t[r],e))return!0;r++}return!1},Gt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jt={},Vt={},Zt={INDEXEDDB:X,WEBSQL:At,LOCALSTORAGE:Xt},te=[Zt.INDEXEDDB._driver,Zt.WEBSQL._driver,Zt.LOCALSTORAGE._driver],ee=["dropInstance"],ne=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee),re={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function oe(t,e){t[e]=function(){var n=arguments;return t.ready().then((function(){return t[e].apply(t,n)}))}}function ie(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Gt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var ce=new(function(){function t(e){for(var n in o(this,t),Zt)if(Zt.hasOwnProperty(n)){var r=Zt[n],i=r._driver;this[n]=i,Jt[i]||this.defineDriver(r)}this._defaultConfig=ie({},re),this._config=ie({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new s((function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(o);for(var i=ne.concat("_initStorage"),c=0,u=i.length;c<u;c++){var a=i[c];if((!Yt(ee,a)||t[a])&&"function"!=typeof t[a])return void n(o)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=s.reject(e);return l(n,arguments[arguments.length-1]),n}},n=0,r=ee.length;n<r;n++){var o=ee[n];t[o]||(t[o]=e(o))}}();var f=function(n){Jt[r]&&console.info("Redefining LocalForage driver: "+r),Jt[r]=t,Vt[r]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(f,n):f(!!t._support):f(!0)}catch(t){n(t)}}));return f(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=Jt[t]?s.resolve(Jt[t]):s.reject(new Error("Driver not found."));return f(r,e,n),r},t.prototype.getSerializer=function(t){var e=s.resolve(gt);return f(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return f(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;Gt(t)||(t=[t]);var o=this._getSupportedDrivers(t);function i(){r._config.driver=r.driver()}function c(t){return r._extend(t),i(),r._ready=r._initStorage(r._config),r._ready}function u(t){return function(){var e=0;function n(){for(;e<t.length;){var o=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(c).catch(n)}i();var u=new Error("No available storage method found.");return r._driverSet=s.reject(u),r._driverSet}return n()}}var a=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=a.then((function(){var t=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then((function(t){r._driver=t._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=u(o)}))})).catch((function(){i();var t=new Error("No available storage method found.");return r._driverSet=s.reject(t),r._driverSet})),f(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!Vt[t]},t.prototype._extend=function(t){ie(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ne.length;t<e;t++)oe(this,ne[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=ce},{3:3}]},{},[4])(4)}(It={path:wt,exports:{},require:function(t,e){return _t(null==e&&It.path)}},It.exports),It.exports);const St=function(){try{if(process.env.TESTING)return{get:function(){return Promise.resolve(null)},add:function(){},remove:function(){},clear:function(){}}}catch(t){}return xt.config({driver:xt.INDEXEDDB,name:"roamCrossref",storeName:"roam-crossref"}),{get:async function(t){try{const e=await xt.getItem(t);return e?e.ts<Date.now()?(doiCache.remove(t),null):e:null}catch(t){return null}},add:function(t,e,n){t&&xt.setItem(t,{ts:Date.now()+864e5,title:n,...e})},remove:function(t){xt.removeItem(t)},clear:function(){xt.clear()}}}();function Et(t){if(t.author){const e=t.author;if("string"==typeof e)return e;if(Array.isArray(e)&&e.length>0){let t=[];return e.forEach((e=>{t.push(`${e.given} ${e.family}`)})),t.join(",")}}if(t.editor){const e=t.editor;if("string"==typeof e)return e;if(Array.isArray(e)&&e.length>0){let t=[];return e.forEach((e=>{t.push(`${e.given} ${e.family}`)})),t.join(",")}}return""}function kt(t){return t["volume-title"]||"book"===t.type||"monograph"===t.type?"book":"book-chapter"===t.type?"book-chapter":t["journal-title"]||"journal-article"===t.type?"journal-article":(t.retrievedFromCache||t.retrievedFromCrossref,t.unstructured?"unstructured":"unknown")}function Nt(t,e=null){const n="<no title found>";let r;return"book"===e?(r=jt(t,["title","volume-title","DOI"]),r||n):"book-chapter"===e?(r=jt(t,["container-title","title","DOI"]),r||n):"journal-article"===e?(r=jt(t,["title","journal-title","DOI"]),r||n):t.title&&(r=Ot(t.title),r)?r:t.DOI||n}function jt(t,e){let n;for(let r=0;r<e.length;r++)if(n=Ot(t[e[r]]),n)return n;return null}function Ot(t){return"string"==typeof t?t:Array.isArray(t)&&t.length>0?t[0]:null}async function Dt(t){let e;try{e=await fetch(`https://api.crossref.org/works/${t}?mailto=christian.fratta@gmail.com`),e=await e.json()}catch(e){return console.error(e),{DOI:t}}const n=e.message,r=Nt(n,kt(n));return St.add(t,n,r),n}function At(e){let n;function r(t,e){return t[0].unstructured?Bt:Rt}let o=r(e),i=o(e);return{c(){n=h("span"),i.c()},m(t,e){f(t,n,e),i.m(n,null)},p(t,e){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n,null)))},i:t,o:t,d(t){t&&d(n),i.d()}}}function Ct(t){let e,n;return e=new ot({props:{doi:t[1],title:t[2],$$slots:{default:[Lt]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};33&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function Rt(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function Bt(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function Tt(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function Ft(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function Lt(t){let e;function n(t,e){return t[0].unstructured?Ft:Tt}let r=n(t),o=r(t);return{c(){o.c(),e=g()},m(t,n){o.m(t,n),f(t,e,n)},p(t,i){r===(r=n(t))&&o?o.p(t,i):(o.d(1),o=r(t),o&&(o.c(),o.m(e.parentNode,e)))},d(t){o.d(t),t&&d(e)}}}function zt(t){let e,n,r,o,i;const c=[Ct,At],u=[];return r=function(t,e){return t[1]?0:1}(t),o=u[r]=c[r](t),{c(){e=h("li"),n=m("📚\n  "),o.c(),b(e,"data-citation-type",Mt)},m(t,o){f(t,e,o),l(e,n),u[r].m(e,null),i=!0},p(t,[e]){o.p(t,e)},i(t){i||(U(o),i=!0)},o(t){q(o),i=!1},d(t){t&&d(e),u[r].d()}}}const Mt="book";function Pt(t,e,n){let{data:r}=e;const o=r.DOI||null;let i=Nt(r,Mt),c=Et(r),u=r.year;return t.$$set=t=>{"data"in t&&n(0,r=t.data)},[r,o,i,c,u]}class Ut extends G{constructor(t){super(),Y(this,t,Pt,zt,i,{data:0})}}function qt(e){let n;function r(t,e){return t[0].unstructured?Kt:Ht}let o=r(e),i=o(e);return{c(){n=h("span"),i.c()},m(t,e){f(t,n,e),i.m(n,null)},p(t,e){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n,null)))},i:t,o:t,d(t){t&&d(n),i.d()}}}function Wt(t){let e,n;return e=new ot({props:{doi:t[1],title:t[2],$$slots:{default:[Yt]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};33&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function Ht(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function Kt(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function Xt(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function Qt(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function Yt(t){let e;function n(t,e){return t[0].unstructured?Qt:Xt}let r=n(t),o=r(t);return{c(){o.c(),e=g()},m(t,n){o.m(t,n),f(t,e,n)},p(t,i){r===(r=n(t))&&o?o.p(t,i):(o.d(1),o=r(t),o&&(o.c(),o.m(e.parentNode,e)))},d(t){o.d(t),t&&d(e)}}}function Gt(t){let e,n,r,o;const i=[Wt,qt],c=[];return n=function(t,e){return t[1]?0:1}(t),r=c[n]=i[n](t),{c(){e=h("li"),r.c(),b(e,"data-citation-type",Jt)},m(t,r){f(t,e,r),c[n].m(e,null),o=!0},p(t,[e]){r.p(t,e)},i(t){o||(U(r),o=!0)},o(t){q(r),o=!1},d(t){t&&d(e),c[n].d()}}}const Jt="book-chapter";function Vt(t,e,n){let{data:r}=e;const o=r.DOI||null,i=Nt(r,Jt),c=Et(r),u=r.year;return t.$$set=t=>{"data"in t&&n(0,r=t.data)},[r,o,i,c,u]}class Zt extends G{constructor(t){super(),Y(this,t,Vt,Gt,i,{data:0})}}function te(e){let n;function r(t,e){return t[0].unstructured?re:ne}let o=r(e),i=o(e);return{c(){n=h("span"),i.c()},m(t,e){f(t,n,e),i.m(n,null)},p(t,e){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n,null)))},i:t,o:t,d(t){t&&d(n),i.d()}}}function ee(t){let e,n;return e=new ot({props:{doi:t[1],title:t[2],$$slots:{default:[ce]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};65&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function ne(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function re(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function oe(e){let n,r,o,i=e[3]&&function(e){let n;return{c(){n=m(e[3])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e),c=e[4]&&function(e){let n,r,o;return{c(){n=m("("),r=m(e[4]),o=m("),")},m(t,e){f(t,n,e),f(t,r,e),f(t,o,e)},p:t,d(t){t&&d(n),t&&d(r),t&&d(o)}}}(e),u=e[2]&&function(e){let n;return{c(){n=m(e[2])},m(t,e){f(t,n,e)},p:t,d(t){t&&d(n)}}}(e);return{c(){i&&i.c(),n=v(),c&&c.c(),r=v(),u&&u.c(),o=g()},m(t,e){i&&i.m(t,e),f(t,n,e),c&&c.m(t,e),f(t,r,e),u&&u.m(t,e),f(t,o,e)},p(t,e){t[3]&&i.p(t,e),t[4]&&c.p(t,e),t[2]&&u.p(t,e)},d(t){i&&i.d(t),t&&d(n),c&&c.d(t),t&&d(r),u&&u.d(t),t&&d(o)}}}function ie(t){let e,n=t[0].unstructured+"";return{c(){e=m(n)},m(t,n){f(t,e,n)},p(t,r){1&r&&n!==(n=t[0].unstructured+"")&&$(e,n)},d(t){t&&d(e)}}}function ce(t){let e;function n(t,e){return t[0].unstructured?ie:oe}let r=n(t),o=r(t);return{c(){o.c(),e=g()},m(t,n){o.m(t,n),f(t,e,n)},p(t,i){r===(r=n(t))&&o?o.p(t,i):(o.d(1),o=r(t),o&&(o.c(),o.m(e.parentNode,e)))},d(t){o.d(t),t&&d(e)}}}function ue(t){let e,n,r,o,i;const c=[ee,te],u=[];return r=function(t,e){return t[1]?0:1}(t),o=u[r]=c[r](t),{c(){e=h("li"),n=m("📑\n  "),o.c(),b(e,"data-citation-type",ae)},m(t,o){f(t,e,o),l(e,n),u[r].m(e,null),i=!0},p(t,[e]){o.p(t,e)},i(t){i||(U(o),i=!0)},o(t){q(o),i=!1},d(t){t&&d(e),u[r].d()}}}const ae="journal-article";function se(t,e,n){let{data:r}=e;const o=r.DOI||null,i=Nt(r,ae),c=Et(r),u=function(){if(r.issued&&r.issued["date-parts"]&&r.issued["date-parts"].length>0)return r.issued["date-parts"][0][0];if(r["published-print"]&&r["published-print"]["date-parts"]&&r["published-print"]["date-parts"].length>0)return r["published-print"]["date-parts"][0][0];if(r["journal-issue"]&&r["journal-issue"]["published-print"]&&r["journal-issue"]["published-print"]["date-parts"].length>0)return r["journal-issue"]["published-print"]["date-parts"][0][0];if(r.year)return r.year;return null}();return t.$$set=t=>{"data"in t&&n(0,r=t.data)},[r,o,i,c,u]}class le extends G{constructor(t){super(),Y(this,t,se,ue,i,{data:0})}}function fe(e){let n,r,o=e[0]&&function(e){let n,r,o,i;return o=new ot({props:{doi:e[0],title:e[0]}}),{c(){n=h("li"),r=m("❓\n    "),H(o.$$.fragment),b(n,"data-citation-type","unknown")},m(t,e){f(t,n,e),l(n,r),K(o,n,null),i=!0},p:t,i(t){i||(U(o.$$.fragment,t),i=!0)},o(t){q(o.$$.fragment,t),i=!1},d(t){t&&d(n),X(o)}}}(e);return{c(){o&&o.c(),n=g()},m(t,e){o&&o.m(t,e),f(t,n,e),r=!0},p(t,[e]){t[0]&&o.p(t,e)},i(t){r||(U(o),r=!0)},o(t){q(o),r=!1},d(t){o&&o.d(t),t&&d(n)}}}function de(t,e,n){let{data:r}=e;const o=r.DOI;return t.$$set=t=>{"data"in t&&n(1,r=t.data)},[o,r]}class pe extends G{constructor(t){super(),Y(this,t,de,fe,i,{data:1})}}function he(e){let n;return{c(){n=h("span"),n.textContent=`${e[1]}`},m(t,e){f(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function me(e){let n,r;return n=new ot({props:{doi:e[0],title:e[1]}}),{c(){H(n.$$.fragment)},m(t,e){K(n,t,e),r=!0},p:t,i(t){r||(U(n.$$.fragment,t),r=!0)},o(t){q(n.$$.fragment,t),r=!1},d(t){X(n,t)}}}function ve(t){let e,n,r,o;const i=[me,he],c=[];return n=function(t,e){return t[0]?0:1}(t),r=c[n]=i[n](t),{c(){e=h("li"),r.c(),b(e,"data-citation-type","unstructured")},m(t,r){f(t,e,r),c[n].m(e,null),o=!0},p(t,[e]){r.p(t,e)},i(t){o||(U(r),o=!0)},o(t){q(r),o=!1},d(t){t&&d(e),c[n].d()}}}function ge(t,e,n){let{data:r}=e;const o=r.DOI||null,i=r.unstructured;return t.$$set=t=>{"data"in t&&n(2,r=t.data)},[o,i,r]}class ye extends G{constructor(t){super(),Y(this,t,ge,ve,i,{data:2})}}function be(t){let e,n;return e=new pe({props:{data:t[0]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function $e(t){let e,n;return e=new ye({props:{data:t[0]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function _e(t){let e,n;return e=new le({props:{data:t[0]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function we(t){let e,n;return e=new Zt({props:{data:t[0]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function Ie(t){let e,n;return e=new Ut({props:{data:t[0]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function xe(t){let e,n,r,o;const i=[Ie,we,_e,$e,be],c=[];function u(t,e){return"book"===t[1]?0:"book-chapter"===t[1]?1:"journal-article"===t[1]?2:"unstructured"===t[1]?3:4}return e=u(t),n=c[e]=i[e](t),{c(){n.c(),r=g()},m(t,n){c[e].m(t,n),f(t,r,n),o=!0},p(t,[o]){let a=e;e=u(t),e===a?c[e].p(t,o):(M(),q(c[a],1,1,(()=>{c[a]=null})),P(),n=c[e],n?n.p(t,o):(n=c[e]=i[e](t),n.c()),U(n,1),n.m(r.parentNode,r))},i(t){o||(U(n),o=!0)},o(t){q(n),o=!1},d(t){c[e].d(t),t&&d(r)}}}function Se(t,e,n){let{data:r}=e;const o=r.DOI||null;let i,c;return c=r,o&&async function(){let t=await St.get(o);if(t)return t.retrievedFromCache=!0,void n(0,c=t);try{t=await Dt(o),t.retrievedFromCrossref=!0}catch(t){}n(0,c=t)}(),t.$$set=t=>{"data"in t&&n(2,r=t.data)},t.$$.update=()=>{1&t.$$.dirty&&n(1,i=kt(c))},[c,i,r]}class Ee extends G{constructor(t){super(),Y(this,t,Se,xe,i,{data:2})}}function ke(t,e,n){const r=t.slice();return r[5]=e[n],r}function Ne(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function je(t){let e,n,r,o,i,c=t[4].abstract&&Oe(t);const u=[Ce,Ae],a=[];function s(t,e){return t[4].reference&&t[4].reference.length>0?0:1}return r=s(t),o=a[r]=u[r](t),{c(){c&&c.c(),e=v(),n=h("ul"),o.c()},m(t,o){c&&c.m(t,o),f(t,e,o),f(t,n,o),a[r].m(n,null),i=!0},p(t,i){t[4].abstract?c?(c.p(t,i),1&i&&U(c,1)):(c=Oe(t),c.c(),U(c,1),c.m(e.parentNode,e)):c&&(M(),q(c,1,1,(()=>{c=null})),P());let l=r;r=s(t),r===l?a[r].p(t,i):(M(),q(a[l],1,1,(()=>{a[l]=null})),P(),o=a[r],o?o.p(t,i):(o=a[r]=u[r](t),o.c()),U(o,1),o.m(n,null))},i(t){i||(U(c),U(o),i=!0)},o(t){q(c),q(o),i=!1},d(t){c&&c.d(t),t&&d(e),t&&d(n),a[r].d()}}}function Oe(t){let e,n,r;return n=new bt({props:{id:"abstractCollapse",titleOpen:"Hide abstract",titleClosed:"Show abstract",$$slots:{default:[De]},$$scope:{ctx:t}}}),{c(){e=h("div"),H(n.$$.fragment),_(e,"margin-top","0.75rem"),_(e,"margin-bottom","0.1rem")},m(t,o){f(t,e,o),K(n,e,null),r=!0},p(t,e){const r={};257&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(U(n.$$.fragment,t),r=!0)},o(t){q(n.$$.fragment,t),r=!1},d(t){t&&d(e),X(n)}}}function De(t){let e,n,r=`${t[4].abstract}`;return{c(){n=g(),e=new I(n)},m(t,o){e.m(r,t,o),f(t,n,o)},p(t,n){1&n&&r!==(r=`${t[4].abstract}`)&&e.p(r)},d(t){t&&d(n),t&&e.d()}}}function Ae(e){let n;return{c(){n=h("div"),n.textContent="No references available for this DOI :(",_(n,"text-align","center"),_(n,"padding","10px")},m(t,e){f(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function Ce(t){let e,n,r=t[4].reference,o=[];for(let e=0;e<r.length;e+=1)o[e]=Re(ke(t,r,e));const i=t=>q(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=g()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);f(t,e,r),n=!0},p(t,n){if(3&n){let c;for(r=t[4].reference,c=0;c<r.length;c+=1){const i=ke(t,r,c);o[c]?(o[c].p(i,n),U(o[c],1)):(o[c]=Re(i),o[c].c(),U(o[c],1),o[c].m(e.parentNode,e))}for(M(),c=r.length;c<o.length;c+=1)i(c);P()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)U(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)q(o[t]);n=!1},d(t){p(o,t),t&&d(e)}}}function Re(t){let e,n;return e=new Ee({props:{data:t[5]}}),{c(){H(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[5]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function Be(e){let n;return{c(){n=h("div"),n.textContent="Loading...",_(n,"margin","2rem"),_(n,"text-align","center")},m(t,e){f(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function Te(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!1,pending:Be,then:je,catch:Ne,value:4,blocks:[,,,]};return W(n=t[1](t[0]),o),{c(){e=h("div"),o.block.c()},m(t,n){f(t,e,n),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null,r=!0},p(e,[r]){if(t=e,o.ctx=t,1&r&&n!==(n=t[1](t[0]))&&W(n,o));else{const e=t.slice();e[4]=o.resolved,o.block.p(e,r)}},i(t){r||(U(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1){q(o.blocks[t])}r=!1},d(t){t&&d(e),o.block.d(),o.token=null,o=null}}}function Fe(t,e,n){let{doi:r}=e;function o(t){return Nt(t,kt(t))}function i(t){Z.update((()=>t))}return t.$$set=t=>{"doi"in t&&n(0,r=t.doi)},[r,async function(t){let e=await St.get(t);return e?(i(o(e)),e):(e=await Dt(t),i(o(e)),e)}]}class Le extends G{constructor(t){super(),Y(this,t,Fe,Te,i,{doi:0})}}function ze(e){let n;return{c(){n=h("div"),n.innerHTML='<b>Couldn&#39;t find the DOI. Make sure you&#39;re writing the iframe as</b> \n      <div class="svelte-142cctv"><code>{{ iframe: https://equineontology.github.io/roam-crossref?doi=\n          <mark>YOUR_DOI_HERE</mark>\n          }}</code></div>',b(n,"class","invalid-doi svelte-142cctv")},m(t,e){f(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function Me(t){let e,n,r;function o(e){t[2].call(null,e)}let i={};return void 0!==t[0]&&(i.doi=t[0]),e=new Le({props:i}),N.push((()=>function(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}(e,"doi",o))),{c(){H(e.$$.fragment)},m(t,n){K(e,t,n),r=!0},p(t,r){const o={};!n&&1&r&&(n=!0,o.doi=t[0],function(t){O.push(t)}((()=>n=!1))),e.$set(o)},i(t){r||(U(e.$$.fragment,t),r=!0)},o(t){q(e.$$.fragment,t),r=!1},d(t){X(e,t)}}}function Pe(t){let e,n,r,o,i,c,u,a,s,p,m;c=new vt({props:{title:t[1]}});const g=[Me,ze],y=[];function $(t,e){return t[0]?0:1}return s=$(t),p=y[s]=g[s](t),{c(){e=h("meta"),n=h("meta"),r=h("meta"),o=h("link"),i=v(),H(c.$$.fragment),u=v(),a=h("div"),p.c(),document.title="Roam Crossref",b(e,"name","description"),b(e,"content","A utility to pull crossref.org data for papers and add it to RoamResearch"),b(n,"name","author"),b(n,"content","Christian Fratta"),b(r,"name","viewport"),b(r,"content","width=device-width, initial-scale=1"),b(o,"rel","stylesheet"),b(o,"href","https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"),b(o,"integrity","sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="),b(o,"crossorigin","anonymous"),b(a,"class","svelte-142cctv")},m(t,d){l(document.head,e),l(document.head,n),l(document.head,r),l(document.head,o),f(t,i,d),K(c,t,d),f(t,u,d),f(t,a,d),y[s].m(a,null),m=!0},p(t,[e]){const n={};2&e&&(n.title=t[1]),c.$set(n);let r=s;s=$(t),s===r?y[s].p(t,e):(M(),q(y[r],1,1,(()=>{y[r]=null})),P(),p=y[s],p?p.p(t,e):(p=y[s]=g[s](t),p.c()),U(p,1),p.m(a,null))},i(t){m||(U(c.$$.fragment,t),U(p),m=!0)},o(t){q(c.$$.fragment,t),q(p),m=!1},d(t){d(e),d(n),d(r),d(o),t&&d(i),X(c,t),t&&d(u),t&&d(a),y[s].d()}}}function Ue(t,e,n){let r,o,i;function u(){const t=window.location.search,e=new URLSearchParams(t);tt.set(e.get("doi"))}return c(t,et,(t=>n(3,r=t))),c(t,tt,(t=>n(0,o=t))),c(t,Z,(t=>n(1,i=t))),function(t){E().$$.on_mount.push(t)}((()=>{u(),addEventListener("popstate",(()=>{!function(){if(r.length>0&&r[r.length-1].doi===o)return;et.update((t=>[...t,{doi:o,title:i}]))}(),u()}))})),[o,i,function(t){o=t,tt.set(o)}]}return new class extends G{constructor(t){super(),Y(this,t,Ue,Pe,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
